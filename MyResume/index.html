<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Inscripciones a Becas</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/icons8-el-intercambio-de-conocimientos-80.png" rel="icon">


    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link type="image/png" sizes="32x32" rel="icon" href=".../icons8-familia-hombre-mujer-32.pn">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

</head>

<body>

    <!-- ======= Mobile nav toggle button ======= -->
    <!-- <button type="button" class="mobile-nav-toggle d-xl-none"><i class="bi bi-list mobile-nav-toggle"></i></button> -->
    <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
    <!-- ======= Header ======= -->
    <header id="header" class="d-flex flex-column justify-content-center">

        <nav id="navbar" class="navbar nav-menu">
            <ul>
                <li><a href="#hero" class="nav-link scrollto active"><i class="bx bx-home"></i> <span>Inicio</span></a></li>
                <li><a href="#about" class="nav-link scrollto"><i class="bx bx-book-content"></i> <span>Acerca de:</span></a></li>
                <li><a href="#resume" class="nav-link scrollto"><i class="bx bx-user"></i> <span>Login</span></a></li>
                <li><a href="#portfolio" class="nav-link scrollto"><i class="bx bx-file-blank"></i> <span>Datos Personales</span></a></li>
                <li><a href="#services" class="nav-link scrollto"><i class="bx bx-file-blank">  </i> <span>Datos Familiares</span></a></li>
                <li><a href="#testimonial5" class="nav-link scrollto"><i class="bx bx-file-blank">  </i> <span>Datos Academicos</span></a></li>

                <li><a href="#contact" class="nav-link scrollto"><i class="bx bx-file-blank"></i> <span>Inscripcion</span></a></li>
            </ul>
        </nav>
        <!-- .nav-menu -->

    </header>
    <!-- End Header -->

    <!-- ======= Hero Section ======= -->
    <section id="hero" class="d-flex flex-column justify-content-center">
        <div class="container" data-aos="zoom-in" data-aos-delay="100">
            <h1>Becas TERCIARIAS Y UNIVERSITARIAS</h1>
            <p>Estudiantes en: <span class="typed" data-typed-items="Rojas, Pergamino, Rosario, La Plata, CABA"></span></p>
            <div class="social-links">
                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
        </div>
    </section>
    <!-- End Hero -->
    <div class="container">
        <div class="row">
            <div class="col">
                <h1>Consulta a base de datos</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-2">
                <input class="form-control altura" type="text" id="ordenarNomb" placeholder="Buscar Nombre">
            </div>
            <div class="col-2">
                <select class="form-control altura" id="orderBy" value="0" placeholder="ordenar por">
                    <option class="form-control altura" value="0">Ordenar por...</option>
                    <option class="form-control altura" value="1">DNI ↑</option>
                    <option class="form-control altura" value="2">DNI ↓</option>
                    <option class="form-control altura" value="3">Id ↑</option>
                    <option class="form-control altura" value="4">Id ↓</option>
                </select>
            </div>
            <div class="col-2">
                <button id="botonModal" type="button" class="btn text-center btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">+</button>
            </div>
            <!-- The Modal -->
            <div class="modal fade" data-bs-backdrop="static" id="myModal">
                <div class="modal-dialog">
                    <div class="modal-content">

                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">Añadir datos</h4>
                            <button id="closeModal(1)" type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>

                        <!-- Modal body -->
                        <div class="container">
                            <form id="formAdd">
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <label for="texto de ejemplo" class="form-label">Nombre Completo</label>
                                            <input name="nombreCompleto" type="text" id="nombreCompleto" min="0" max="255" placeholder="" class="form-control">
                                        </div>
                                        <div class="col-6">
                                            <label for="texto de ejemplo" class="form-label">DNI</label>
                                            <input name="dni" type="text" id="dni" min="0" max="11" placeholder="" class="form-control">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <label for="texto de ejemplo" class="form-label">Email</label>
                                            <input name="email" type="text" id="email" min="0" max="255" placeholder="" class="form-control">
                                        </div>
                                        <div class="col-6">
                                            <label for="texto de ejemplo" class="form-label">Contraseña</label>
                                            <input name="contraseña" type="text" id="contrasenna" min="0" max="255" class="form-control">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <label for="texto de ejemplo" class="form-label">Tipo de usuario</label>
                                            <input name="tipoUsuario" type="text" id="tipoUsuario" min="0" max="1" placeholder="" class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Modal footer -->
                        <div class="modal-footer">
                            <button id="closeModal2(1)" type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                            <button id="addData" type="button" class="btn btn-primary xd">enviar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="xd">ID usuarios</th>
                            <th class="xd">Nombre Completo</th>
                            <th class="xd">DNI</th>
                            <th class="xd">Email</th>
                            <th class="xd">Contraseña</th>
                            <th class="xd">Tipo de usuario</th>
                            <!-- th class="xd">Datos Personales</th -->
                            <th class="xd">Editar</th>
                            <th class="xd">Eliminar</th>
                        </tr>
                    </thead>
                    <tbody id="tabla1">

                    </tbody>
                </table>
            </div>
            <div class="col-2">
                <!-- The Modal -->
                <div class="modal fade" data-bs-backdrop="static" id="modalUD">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <form id="formUD">
                                <!-- Modal Header -->
                                <div class="modal-header">
                                    <div class="col-5">
                                        <h4 class="modal-title">Editar datos</h4>
                                    </div>
                                    <div class="col-2">
                                        <label>id</label><input type="text" class="form-control" name="idUD" id="idUD" readonly>
                                    </div>
                                    <div class="col-5 text-end">
                                        <button id="closeModalUD" type="button" onclick="" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                </div>

                                <!-- Modal body -->
                                <div class="container">
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-6">
                                                <label for="texto de ejemplo" class="form-label">Nombre Completo</label>
                                                <input name="nombreCompletoUD" min="0" max="255" type="text" id="nombreCompletoUD" placeholder="" class="form-control">
                                            </div>
                                            <div class="col-6">
                                                <label for="texto de ejemplo" class="form-label">DNI</label>
                                                <input name="dniUD" type="text" id="dniUD" min="0" max="11" placeholder="" class="form-control">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <label for="texto de ejemplo" class="form-label">Email</label>
                                                <input name="emailUD" type="text" min="0" max="255" id="emailUD" placeholder="" class="form-control">
                                            </div>
                                            <div class="col-6">
                                                <label for="texto de ejemplo" class="form-label">Contraseña</label>
                                                <input name="contrasennaUD" type="text" min="0" max="255" id="contrasennaUD" class="form-control">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <label for="texto de ejemplo" class="form-label">Tipo de usuario</label>
                                                <input name="tipoUsuarioUD" type="text" min="0" max="1" id="tipoUsuarioUD" placeholder="" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <!-- Modal footer -->
                            <div class="modal-footer">
                                <button id="closeModalUD2" type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                                <button id="editData" type="button" class="btn btn-primary xd">enviar</button>
                                <button id="deleteData" type="button" class="btn btn-danger xd">eliminar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>



<script>
    $(document).ready(function() {

        $("#addData").click(function() {

            var datos = $('#formAdd').serializeArray();
            console.log(datos)


            if (validarDatos(datos)) {
                $.ajax({
                    type: "POST",
                    url: "addUsuarios.php",
                    data: datos,
                    success: function(r) {
                        if (r == 1) {
                            alert("agregado con exito");
                            $("#ordenarNomb").val(nombreCompleto.value)
                            cargarTabla();
                            $("#myModal").modal('hide')
                        } else {
                            alert("Fallo");
                        }
                    }
                })
            } else {
                console.log("algo anda mal")
            }


        })

        function validarDatos(datos) {
            var valido = true
            console.log("array en validarDatos():", datos)

            if (datos[0].value.length == 0 || datos[0].value.length > 255) {
                alert("Nombre no valido")
                    //console.log("Nombre completo no valido",datos[0].value.length)
                valido = false
            } else {
                //console.log("Nombre completo valido",datos[0].value, datos[0].value.length)
                if (datos[1].value.length < 7 || datos[1].value.length > 11) {
                    alert("DNI no valido")
                        //console.log("dni no valido",datos[1].value.length)
                    valido = false
                } else {
                    //console.log("dni valido", datos[1].value.length)
                    if (datos[2].value.length == 0 || datos[2].value.length > 255) {
                        alert("Correo eletronico no valido")
                            //console.log("email no valido",datos[2].value.length)
                        valido = false
                    } else {
                        //console.log("email valido",datos[2].value.length)
                        if (datos[3].value.length == 0 || datos[3].value.length > 255) {
                            alert("Contraseña no valida")
                                //console.log("contraseña no valida",datos[3].value.length)
                            valido = false
                        } else {
                            //console.log("contraseña valida",datos[3].value.length)
                            if (datos[4].value != "A" && datos[4].value != "U" || datos[4].value.length == 0 || datos[4].value.length > 1) {
                                alert("Tipo de usuario no valido")
                                    //console.log("tipo de usuario no valido",datos[4].value.length)
                                valido = false
                            } else {
                                return true;
                                //console.log("tipo de usuario valida",datos[4].value.length)
                            }
                        }
                    }
                }
            }

        }

        function confirmEdit() {
            var editarDatos = $("#formUD").serializeArray();
            //console.log("array: ", editarDatos)
            var datos = [editarDatos[1], editarDatos[2], editarDatos[3], editarDatos[4], editarDatos[5]]

            if (validarDatos(datos)) {
                $.ajax({
                    url: "RenameUsuarios.php",
                    type: "POST",
                    data: editarDatos,
                    success: function(r) {
                        if (r == 1) {

                            alert("datos modificados con exito")
                            $("#ordenarNomb").val(nombreCompletoUD.value)
                            cargarTabla()
                            $("#modalUD").modal('hide')

                        }
                    }
                })
            } else {
                console.log("algo anda mal")
            }
        }

        function confirmDelete() {
            var eliminarDatos = $("#formUD").serializeArray();
            //console.log("editarDatos: ", eliminarDatos)
            $.ajax({
                url: "DeleteUsuarios.php",
                type: "POST",
                data: eliminarDatos,
                success: function(r) {
                    if (r == 1) {

                        alert("datos Eliminados")
                        cargarTabla()
                        $("#modalUD").modal('hide')

                    }
                }
            })
        }

        $("#editData").on("click", function() {
            confirmEdit()
        })
        $("#deleteData").on("click", function() {
                confirmDelete()
            })
            //$("#closemodalUD2")
            //$("#closemodalUD")

        function cargarFormEdit(value) {

            //$("#ordenarNomb").val('')
            $("#editData").show()
            $("#deleteData").hide()

            //console.log("xd",value)

            $("#idUD").val(value.id_usuario)
            $("#idUD").attr('placeholder', value.id_usuario)

            $("#nombreCompletoUD").val(value.nombre_completo)
            $("#nombreCompletoUD").attr('placeholder', value.nombre_completo)
            $("#nombreCompletoUD").attr('readonly', false)

            $("#dniUD").val(value.dni)
            $("#dniUD").attr('placeholder', value.dni)
            $("#dniUD").attr('readonly', false)

            $("#emailUD").val(value.email)
            $("#emailUD").attr('placeholder', value.email)
            $("#emailUD").attr('readonly', false)

            $("#contrasennaUD").val(value.contrasenna)
            $("#contrasennaUD").attr('placeholder', value.contrasenna)
            $("#contrasennaUD").attr('readonly', false)

            $("#tipoUsuarioUD").val(value.tipo_usuario)
            $("#tipoUsuarioUD").attr('placeholder', value.tipo_usuario)
            $("#tipoUsuarioUD").attr('readonly', false)

        }

        function cargarFormDelete(value) {
            $("#deleteData").show()
            $("#editData").hide()


            //console.log("value: ", value)

            $("#idUD").val(value.id_usuario)
            $("#idUD").attr('placeholder', value.id_usuario)

            $("#nombreCompletoUD").val(value.nombre_completo)
            $("#nombreCompletoUD").attr('placeholder', value.nombre_completo)
            $("#nombreCompletoUD").attr('readonly', true)

            $("#dniUD").val(value.dni)
            $("#dniUD").attr('placeholder', value.dni)
            $("#dniUD").attr('readonly', true)

            $("#emailUD").val(value.email)
            $("#emailUD").attr('placeholder', value.email)
            $("#emailUD").attr('readonly', true)

            $("#contrasennaUD").val(value.contrasenna)
            $("#contrasennaUD").attr('placeholder', value.contrasenna)
            $("#contrasennaUD").attr('readonly', true)

            $("#tipoUsuarioUD").val(value.tipo_usuario)
            $("#tipoUsuarioUD").attr('placeholder', value.tipo_usuario)
            $("#tipoUsuarioUD").attr('readonly', true)


        }

        function cargarTabla() {
            $("#tabla1").empty()
            var opt = $("#orderBy").val()
            var l = $("#ordenarNomb").val()
            if (l != "") {
                //console.log("if")
                $.ajax({
                    url: "BackendUsuarios.php", //action
                    type: "POST", //method
                    data: {
                        "letra": l,
                        "opcion": opt
                    },
                    //dataType: "json",
                    success: function(respuesta) {

                        var box = JSON.parse(respuesta)
                        console.log("datos cargados:", box)

                        $.each(box, function(key, value) {
                            //console.log("Respuesta: " + respuesta)
                            //console.log("Key: " , key)
                            //console.log("Value: " , value)

                            $("#tabla1").append("<tr id='fila" + key + "'  >" +
                                "<td class='xd'>" + value.id_usuario + "</td>" +
                                "<td class='xd'>" + value.nombre_completo + "</td>" +
                                "<td class='xd'>" + value.email + "</td>" +
                                "<td class='xd'>" + value.dni + "</td>" +
                                "<td class='xd'>" + value.contrasenna + "</td>" +
                                "<td class='xd'>" + value.tipo_usuario + "</td>" +
                                "<td class='xd'>" + "<button class='btn btn-sm btn-secondary text-center'  id='edit" + key + "' data-bs-toggle='modal' data-bs-target='#modalUD' >" + "<img class='iconsize xd' src='edit.png'>" + "</button>" + "</td>" +
                                "<td class='xd'>" + "<button class='btn btn-sm btn-danger text-center'  id='delete" + key + "' data-bs-toggle='modal' data-bs-target='#modalUD' >" + "<img class='iconsize xd' src='delete.png'>" + "</td>" +
                                "</tr>")

                            $("#edit" + key).on("click", function() {
                                //console.log(value)
                                cargarFormEdit(value)
                            })

                            $("#delete" + key).on("click", function() {
                                //console.log(value)
                                cargarFormDelete(value)
                            })

                            key = key + 1

                        })

                    }

                })
            }

        }

        $("#orderBy").change(function() {
            cargarTabla();
        })

        $("#ordenarNomb").keyup(function() {
            cargarTabla();
        })
    })
</script>
<style>
    .xd {
        text-align: center;
    }
    
    .iconsize {
        height: 30px;
        width: 30px;
    }
    
    .altura {
        height: 40px;
    }
</style>




<!-- End #main -->

<!-- ======= Footer ======= -->
<footer id="footer">
    <div class="container">
        <h3>Brandon Johnson</h3>
        <p>Et aut eum quis fuga eos sunt ipsa nihil. Labore corporis magni eligendi fuga maxime saepe commodi placeat.</p>
        <div class="social-links">
            <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
            <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
            <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
            <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
            <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
        </div>
    </div>
</footer>
<!-- End Footer -->

<div id="preloader"></div>
<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

<!-- Vendor JS Files -->
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/typed.js/typed.min.js"></script>
<script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>

<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>